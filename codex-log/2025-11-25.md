# Codex Log — 2025-11-25

## Step 1
- Aligned properties-related entities with this codebase (imports, enums, relations) and removed unused references.
- Added repositories for all properties-related entities under `src/api/repositories/postgres/properties-related/`.
- Documented properties domain and scrape/enrichment flow (`src/api/entities/properties-related/README.md`).
- Introduced global AWS module with DynamoDB client and `PropertiesDynamoService` helpers; documented usage (`src/api/common/aws/README.md`).
- Added DynamoDB dependencies to `package.json` for upcoming admin import/scraper features.

Add further steps for this date beneath as we make more changes.

## Step 2
- Added Dynamo health check endpoint `GET /common/aws/dynamo-health` to verify connectivity and table reachability.
- Extended `PropertiesDynamoService` with `healthCheck()` method to run a lightweight scan against the configured table.

## Step 3
- Added Admin Properties module with `POST /admin/properties/import-outreach` to pull Dynamo backlog items and upsert `Property` records; create `PropertyListing` when a status is present.
- Handles pagination via `limit` and `lastEvaluatedKeyRaw` (composite key `zpid`+`snapshot`), marks processed items in Dynamo, and supports `dryRun`.
- County is optional (attached when resolvable by name/state/zip); missing status just skips listing creation and logs a warning.
- Status normalization added (`UNDER_CONTRACT`→`PENDING`, `ACTIVE`→`FOR_SALE`, etc.), and multi-pass scan ensures batches fill even when filters skip items.
- Registered properties-related entities with TypeORM and cleaned duplicate index on `user-visible-listings`.
- Supports optional per-state filtering (provide `states` array); items outside the set are skipped and reported in `skippedByState`.
- Documented response schema via DTOs for frontend consumers.
- State filter now pushed to Dynamo scan; local skip counter remains for any unexpected mismatches.
- County lookup errors removed from reporting; county is now completely optional during import.
- Importer now uses the `state_outreach` GSI and ingests items with `outreach = 0`, marking them to `1` after processing.
- Items with missing status are skipped early (required for listing creation).
- Status map updated to accept `FOR_SALE_AGAIN` (maps to FOR_SALE) and `COMING_SOON`.
